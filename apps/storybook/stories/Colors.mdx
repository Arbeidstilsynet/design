import { Meta, ColorPalette, ColorItem } from "@storybook/addon-docs/blocks";

import { useEffect, useRef, useState, useCallback } from "react";
import { getGroupedThemeColors, getThemeColors } from "./getThemeColors";

<Meta title="Colors" />

export const DemoEffect = () => {
  const parentRef = useRef(null);
  const [scheme, setScheme] = useState("light");
  const [colors, setColors] = useState({});
  const readColors = useCallback(() => {
    if (!parentRef.current) return;
    const themeColors = getGroupedThemeColors("--ds-color-", parentRef.current);
    setColors(themeColors);
  }, []);
  useEffect(() => {
    readColors();
  }, [readColors, scheme]);
  const setDark = () => {
    setScheme("dark");
  };
  const setLight = () => {
    setScheme("light");
  };
  return (
    <div
      ref={parentRef}
      data-color-scheme={scheme}
      style={{ padding: "1rem", background: "#ffffff" }}
      className="colors-demo-scope"
    >
      <div>
        <button type="button" onClick={setDark} disabled={scheme === "dark"}>
          Dark mode
        </button>
        <button type="button" onClick={setLight} disabled={scheme === "light"}>
          Light mode
        </button>
      </div>
      <ColorPalette>
        {Object.entries(colors).map(([name, value]) => (
          <ColorItem key={name} title={name} colors={value} />
        ))}
      </ColorPalette>
    </div>
  );
};

<div>
  # Colors from the Arbeidstilsynet theme

Use with `--ds-color-` prefix.
Example `--ds-color-primary-base-active`.

<DemoEffect />

</div>
